---
import { getCollection } from "astro:content";
import CoverImage from "../components/CoverImage.astro";
import SocialMediaIcon from "./SocialMediaIcon.astro";
import LinkButton from "./LinkButton.astro";

const filterIssues = (await getCollection("issues")).filter((post) => post.data.currentIssue === true);
const currentIssue = filterIssues.length > 0 ? filterIssues[0] : null;
---

<div class="h-full flex-initial p-3">
  <aside class="pb-10">
    <h2 class="mt-0 font-sans text-lg font-normal antialiased uppercase">Our Current Issue</h2>
    <div class="mt-3 mb-6 border-b-subfooter border-lsq-orange w-1/2"></div>
    <div class="textwidget">
      <a href={`/issues/${currentIssue?.data?.issueNumber}`}
        ><CoverImage
          imagePath={currentIssue?.data?.coverImage ?? ""}
          altText={`Cover of ${currentIssue?.data?.title ?? ""}`}
        /></a
      >
      <LinkButton url={`/issues/${currentIssue?.data?.issueNumber}`} linkText="Get The Details" />
    </div>
  </aside>

  <aside class="pb-10">
    <h2 class="mt-0 font-sans text-lg font-normal antialiased uppercase">Follow Us</h2>
    <div class="mt-3 mb-6 border-b-subfooter border-lsq-orange w-1/2"></div>
    <div class="container w-full flex flex-row not-prose">
      <SocialMediaIcon
        href="https://www.twitter.com/lunaquarterly"
        src="/images/social_media_icons/twitter_icon.png"
        alt="Twitter"
      />
      <SocialMediaIcon
        href="https://www.facebook.com/lunastnquarterly/"
        src="/images/social_media_icons/facebook_icon.png"
        alt="Facebook"
      />
      <SocialMediaIcon
        href="http://lunastationquarterly.tumblr.com/"
        src="/images/social_media_icons/tumblr_icon.png"
        alt="Tumblr"
      />
      <SocialMediaIcon
        href="https://www.goodreads.com/user/show/5121825-luna-station-quarterly"
        src="/images/social_media_icons/goodreads_icon.png"
        alt="Goodreads"
      />
      <SocialMediaIcon
        href="https://wandering.shop/@lunastation"
        src="/images/social_media_icons/mastodon_icon.png"
        alt="Mastodon"
      />
      <SocialMediaIcon
        href="https://bsky.app/profile/lunastation.bsky.social"
        src="/images/social_media_icons/bluesky_icon.png"
        alt="Bluesky"
      />
    </div>
  </aside>
  <aside class="pb-10">
    <h2 class="mt-0 font-sans text-lg font-normal antialiased uppercase">Support Us on Patreon!</h2>
    <div class="mt-3 mb-6 border-b-subfooter border-lsq-orange w-1/2"></div>
    <div class="cb_p6_patreon_site_widget" style="text-align:left !important;">
      <a
        rel="nofollow"
        target="_blank"
        href="https://patreon.com/lunastation?utm_content=site_sidebar_widget&utm_medium=patron_button_and_widgets_plugin&utm_campaign=93070&utm_term=&utm_source=http://localhost/wordpress-trunk/a-powerful-spread-to-end-the-year/"
        aria-label="Click to become a patron at Patreon!"
        ><img
          style="margin-top: 10px;margin-bottom: 10px;max-width:200px;width:100%;height:auto;"
          src="http://localhost/wordpress-trunk/wp-content/plugins/patron-button-and-widgets-by-codebard/images/become_a_patron_button.png"
          alt="Become a patron at Patreon!"
        /></a
      >
    </div>
  </aside>
  <aside class="pb-10">
    <h2 class="mt-0 font-sans text-lg font-normal antialiased uppercase">Support our favorite retailer</h2><div
      class="textwidget custom-html-widget"
    >
      <div class="mt-3 mb-6 border-b-subfooter border-lsq-orange w-1/2"></div>
      <a href="https://weightlessbooks.com/"
        ><img src="http://localhost/wordpress-trunk/wp-content/uploads/2021/05/weightless-apex-ad.jpg" /></a
      >
    </div>
  </aside>

  <aside class="pb-10">
    <h2 class="mt-0 font-sans text-lg font-normal antialiased uppercase">Subscribe to Our Newsletter</h2><div
      class="textwidget custom-html-widget"
    >
      <div class="mt-3 mb-6 border-b-subfooter border-lsq-orange w-1/2"></div>
      <!-- Begin Mailchimp Signup Form -->
      <link href="//cdn-images.mailchimp.com/embedcode/horizontal-slim-10_7_dtp.css" rel="stylesheet" type="text/css" />
      <style type="text/css">
        #mc_embed_signup {
          background: #fff;
          clear: left;
          font:
            14px Helvetica,
            Arial,
            sans-serif;
          width: 100%;
        }
        /* Add your own Mailchimp form style overrides in your site stylesheet or in this style block.
We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
      </style>
      <style type="text/css">
        #mc-embedded-subscribe-form input[type="checkbox"] {
          display: inline;
          width: auto;
          margin-right: 10px;
        }
        #mergeRow-gdpr {
          margin-top: 20px;
        }
        #mergeRow-gdpr fieldset label {
          font-weight: normal;
        }
        #mc-embedded-subscribe-form .mc_fieldset {
          border: none;
          min-height: 0px;
          padding-bottom: 0px;
        }
      </style>
      <div id="mc_embed_signup">
        <form
          action="https://lunastationpress.us4.list-manage.com/subscribe/post?u=61dd055644bba23b636dd83a6&id=05bd9b6594"
          method="post"
          id="mc-embedded-subscribe-form"
          name="mc-embedded-subscribe-form"
          class="validate"
          target="_blank"
          novalidate=""
        >
          <div id="mc_embed_signup_scroll">
            <input
              type="email"
              value=""
              name="EMAIL"
              class="email"
              id="mce-EMAIL"
              placeholder="email address"
              required=""
              style="width: 100%;"
            />
            <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
            <div style="position: absolute; left: -5000px;" aria-hidden="true">
              <input type="text" name="b_61dd055644bba23b636dd83a6_05bd9b6594" tabindex="-1" value="" />
            </div>
            <div class="clear foot">
              <input
                type="submit"
                value="Subscribe"
                name="subscribe"
                id="mc-embedded-subscribe"
                class="button"
                style="background:#D24619;margin-top:15px;"
              />
            </div>
            <p style="margin-top:20px;">
              <a href="http://eepurl.com/hT2kAX" title="Mailchimp - email marketing made easy and fun"
                ><img
                  class="referralBadge"
                  src="https://eep.io/mc-cdn-images/template_images/branding_logo_text_dark_dtp.svg"
                /></a
              >
            </p>
          </div>
        </form>
      </div>

      <!--End mc_embed_signup-->
    </div>
  </aside>
</div>
